-- GMAO.BATIMENT definition

CREATE TABLE `BATIMENT` (
  `ID_BATIMENT` int NOT NULL AUTO_INCREMENT,
  `NOM_BATIMENT` int NOT NULL,
  PRIMARY KEY (`ID_BATIMENT`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- GMAO.CRITICITE_MACHINE definition

CREATE TABLE `CRITICITE_MACHINE` (
  `ID_CRITICITE_MACHINE` int NOT NULL AUTO_INCREMENT,
  `CRITICITE_MACHINE` varchar(100) NOT NULL,
  `DESCRIPTION_CRITICITE_MACHINE` varchar(100) NOT NULL,
  PRIMARY KEY (`ID_CRITICITE_MACHINE`),
  UNIQUE KEY `CRITICITE_MACHINE_UNIQUE` (`CRITICITE_MACHINE`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- GMAO.CLASSE_MACHINE definition

CREATE TABLE `CLASSE_MACHINE` (
  `ID_CLASSE_MACHINE` int NOT NULL AUTO_INCREMENT,
  `CLASSE_MACHINE` varchar(100) NOT NULL,
  `DESCRIPTION_CLASSE_MACHINE` varchar(100) NOT NULL,
  PRIMARY KEY (`ID_CLASSE_MACHINE`),
  UNIQUE KEY `CLASSE_MACHINE_UNIQUE` (`CLASSE_MACHINE`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- GMAO.ROLE_UTILISATEUR definition

CREATE TABLE `ROLE_UTILISATEUR` (
  `ID_ROLE_UTILISATEUR` int NOT NULL AUTO_INCREMENT,
  `ROLE_UTILISATEUR` varchar(100) NOT NULL,
  PRIMARY KEY (`ID_ROLE_UTILISATEUR`),
  UNIQUE KEY `ROLE_UTILISATEUR_UNIQUE` (`ROLE_UTILISATEUR`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- GMAO.URGENCE_PANNE definition

CREATE TABLE `URGENCE_PANNE` (
  `ID_URGENCE_PANNE` int NOT NULL AUTO_INCREMENT,
  `URGENCE_PANNE` varchar(100) NOT NULL,
  `DESCRIPTION_URGENCE_PANNE` varchar(100) NOT NULL,
  PRIMARY KEY (`ID_URGENCE_PANNE`),
  UNIQUE KEY `URGENCE_PANNE_UNIQUE` (`URGENCE_PANNE`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- GMAO.ETAT_PANNE definition

CREATE TABLE `ETAT_PANNE` (
  `ID_ETAT_PANNE` int NOT NULL AUTO_INCREMENT,
  `ETAT_PANNE` int NOT NULL,
  `DESCRIPTION_ETAT_PANNE` varchar(100) NOT NULL,
  PRIMARY KEY (`ID_ETAT_PANNE`),
  UNIQUE KEY `ETAT_PANNE_UNIQUE` (`ETAT_PANNE`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- GMAO.EMPLACEMENT definition

CREATE TABLE `EMPLACEMENT` (
  `ID_EMPLACEMENT` int NOT NULL AUTO_INCREMENT,
  `NOM_EMPLACEMENT` varchar(100) NOT NULL,
  `BATIMENT_DE_EMPLACEMENT` int NOT NULL,
  PRIMARY KEY (`ID_EMPLACEMENT`),
  KEY `EMPLACEMENT_BATIMENT_FK` (`BATIMENT_DE_EMPLACEMENT`),
  CONSTRAINT `EMPLACEMENT_BATIMENT_FK` FOREIGN KEY (`BATIMENT_DE_EMPLACEMENT`) REFERENCES `BATIMENT` (`ID_BATIMENT`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- GMAO.UR definition

CREATE TABLE `UR` (
  `ID_UR` int NOT NULL AUTO_INCREMENT,
  `NOM_UR` varchar(100) NOT NULL,
  `DESCRIPTION_UR` varchar(100) DEFAULT NULL,
  `BATIMENT_DE_UR` int NOT NULL,
  PRIMARY KEY (`ID_UR`),
  KEY `UR_BATIMENT_FK` (`BATIMENT_DE_UR`),
  CONSTRAINT `UR_BATIMENT_FK` FOREIGN KEY (`BATIMENT_DE_UR`) REFERENCES `BATIMENT` (`ID_BATIMENT`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='Unité de Réalisation';


-- GMAO.MAGASIN definition

CREATE TABLE `MAGASIN` (
  `ID_MAGASIN` int NOT NULL AUTO_INCREMENT,
  `NOM_MAGASIN` varchar(100) NOT NULL,
  `EMPLACEMENT_DE_MAGASIN` int NOT NULL,
  PRIMARY KEY (`ID_MAGASIN`),
  KEY `MAGASIN_EMPLACEMENT_FK` (`EMPLACEMENT_DE_MAGASIN`),
  CONSTRAINT `MAGASIN_EMPLACEMENT_FK` FOREIGN KEY (`EMPLACEMENT_DE_MAGASIN`) REFERENCES `EMPLACEMENT` (`ID_EMPLACEMENT`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- GMAO.SLOT definition

CREATE TABLE `SLOT` (
  `ID_SLOT` int NOT NULL AUTO_INCREMENT,
  `NOM_SLOT` varchar(100) NOT NULL,
  `MAGASIN_DE_SLOT` int NOT NULL,
  PRIMARY KEY (`ID_SLOT`),
  UNIQUE KEY `SLOT_UNIQUE` (`NOM_SLOT`),
  KEY `SLOT_MAGASIN_FK` (`MAGASIN_DE_SLOT`),
  CONSTRAINT `SLOT_MAGASIN_FK` FOREIGN KEY (`MAGASIN_DE_SLOT`) REFERENCES `MAGASIN` (`ID_MAGASIN`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- GMAO.PIECE definition

CREATE TABLE `PIECE` (
  `ID_PIECE` int NOT NULL AUTO_INCREMENT,
  `NOM_PIECE` varchar(100) NOT NULL,
  `DESCRIPTION_PIECE` varchar(100) DEFAULT NULL,
  `QUANTITE` int DEFAULT NULL,
  `PRIX_ACHAT` decimal(10,0) DEFAULT NULL,
  `DATE_MISE_EN_STOCK` date DEFAULT NULL,
  `SLOT_DE_PIECE` int NOT NULL,
  PRIMARY KEY (`ID_PIECE`),
  KEY `PIECE_SLOT_FK` (`SLOT_DE_PIECE`),
  CONSTRAINT `PIECE_SLOT_FK` FOREIGN KEY (`SLOT_DE_PIECE`) REFERENCES `SLOT` (`ID_SLOT`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- GMAO.MACHINE definition

CREATE TABLE `MACHINE` (
  `ID_MACHINE` int NOT NULL AUTO_INCREMENT,
  `MACHINE` varchar(100) NOT NULL,
  `DESCRIPTION_MACHINE` varchar(100) DEFAULT NULL,
  `PHOTO` varchar(100) NOT NULL,
  `DATE_IMPLEMENTATION` date DEFAULT NULL,
  `CRITICITE_MACHINE` int NOT NULL,
  `CLASSE_MACHINE` int NOT NULL,
  `EMPLACEMENT_MACHINE` int NOT NULL,
  `UR_MACHINE` int NOT NULL,
  PRIMARY KEY (`ID_MACHINE`),
  KEY `MACHINE_CLASSE_MACHINE_FK` (`CLASSE_MACHINE`),
  KEY `MACHINE_EMPLACEMENT_FK` (`EMPLACEMENT_MACHINE`),
  KEY `MACHINE_UR_FK` (`UR_MACHINE`),
  CONSTRAINT `MACHINE_CLASSE_MACHINE_FK` FOREIGN KEY (`CLASSE_MACHINE`) REFERENCES `CLASSE_MACHINE` (`ID_CLASSE_MACHINE`),
  CONSTRAINT `MACHINE_CRITICITE_MACHINE_FK` FOREIGN KEY (`CLASSE_MACHINE`) REFERENCES `CRITICITE_MACHINE` (`ID_CRITICITE_MACHINE`),
  CONSTRAINT `MACHINE_EMPLACEMENT_FK` FOREIGN KEY (`EMPLACEMENT_MACHINE`) REFERENCES `EMPLACEMENT` (`ID_EMPLACEMENT`),
  CONSTRAINT `MACHINE_UR_FK` FOREIGN KEY (`UR_MACHINE`) REFERENCES `UR` (`ID_UR`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- GMAO.UTILISATEUR definition

CREATE TABLE `UTILISATEUR` (
  `ID_UTILISATEUR` int NOT NULL AUTO_INCREMENT,
  `NOM_UTILISATEUR` varchar(100) DEFAULT NULL,
  `ROLE_UTILISATEUR` int NOT NULL,
  `UR_UTILISATEUR` int NOT NULL,
  PRIMARY KEY (`ID_UTILISATEUR`),
  KEY `UTILISATEUR_ROLE_UTILISATEUR_FK` (`ROLE_UTILISATEUR`),
  KEY `UTILISATEUR_UR_FK` (`UR_UTILISATEUR`),
  CONSTRAINT `UTILISATEUR_ROLE_UTILISATEUR_FK` FOREIGN KEY (`ROLE_UTILISATEUR`) REFERENCES `ROLE_UTILISATEUR` (`ID_ROLE_UTILISATEUR`),
  CONSTRAINT `UTILISATEUR_UR_FK` FOREIGN KEY (`UR_UTILISATEUR`) REFERENCES `UR` (`ID_UR`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- GMAO.PANNE definition

CREATE TABLE `PANNE` (
  `ID_PANNE` int NOT NULL AUTO_INCREMENT,
  `DATE_DEBUT_PANNE` datetime NOT NULL,
  `DATE_FIN_PANNE` datetime DEFAULT NULL,
  `URGENCE_PANNE` int NOT NULL,
  `ETAT_PANNE` int NOT NULL,
  `UTILISATEUR_DEMANDEUR` int NOT NULL,
  `MACHINE_EN_PANNE` int NOT NULL,
  PRIMARY KEY (`ID_PANNE`),
  KEY `PANNE_URGENCE_PANNE_FK` (`URGENCE_PANNE`),
  KEY `PANNE_ETAT_PANNE_FK` (`ETAT_PANNE`),
  KEY `PANNE_UTILISATEUR_FK` (`UTILISATEUR_DEMANDEUR`),
  KEY `PANNE_MACHINE_FK` (`MACHINE_EN_PANNE`),
  CONSTRAINT `PANNE_ETAT_PANNE_FK` FOREIGN KEY (`ETAT_PANNE`) REFERENCES `ETAT_PANNE` (`ID_ETAT_PANNE`),
  CONSTRAINT `PANNE_MACHINE_FK` FOREIGN KEY (`MACHINE_EN_PANNE`) REFERENCES `MACHINE` (`ID_MACHINE`),
  CONSTRAINT `PANNE_URGENCE_PANNE_FK` FOREIGN KEY (`URGENCE_PANNE`) REFERENCES `URGENCE_PANNE` (`ID_URGENCE_PANNE`),
  CONSTRAINT `PANNE_UTILISATEUR_FK` FOREIGN KEY (`UTILISATEUR_DEMANDEUR`) REFERENCES `UTILISATEUR` (`ID_UTILISATEUR`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- GMAO.INTERVENTION definition

CREATE TABLE `INTERVENTION` (
  `ID_INTERVENTION` int NOT NULL AUTO_INCREMENT,
  `DESCRIPTION_INTERVENTION` varchar(100) DEFAULT NULL,
  `DATE_DEBUT_INTERVENTION` datetime NOT NULL,
  `DATE_FIN_INTERVENTION` datetime NOT NULL,
  `DUREE_INTERVENTION` time NOT NULL,
  `PANNE_DE_INTERVENTION` int NOT NULL,
  PRIMARY KEY (`ID_INTERVENTION`),
  KEY `INTERVENTION_PANNE_FK` (`PANNE_DE_INTERVENTION`),
  CONSTRAINT `INTERVENTION_PANNE_FK` FOREIGN KEY (`PANNE_DE_INTERVENTION`) REFERENCES `PANNE` (`ID_PANNE`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- GMAO.PIECE_MACHINE definition

CREATE TABLE `PIECE_MACHINE` (
  `PIECE_PM` int NOT NULL,
  `MACHINE_PM` int NOT NULL,
  PRIMARY KEY (`PIECE_PM`,`MACHINE_PM`),
  KEY `PIECE_MACHINE_MACHINE_FK` (`MACHINE_PM`),
  CONSTRAINT `PIECE_MACHINE_MACHINE_FK` FOREIGN KEY (`MACHINE_PM`) REFERENCES `MACHINE` (`ID_MACHINE`),
  CONSTRAINT `PIECE_MACHINE_PIECE_FK` FOREIGN KEY (`PIECE_PM`) REFERENCES `PIECE` (`ID_PIECE`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='PM => PIECE_MACHINE';


-- GMAO.INTERVENTION_PIECE definition

CREATE TABLE `INTERVENTION_PIECE` (
  `ID_INTERVENTION_PIECE` int NOT NULL AUTO_INCREMENT,
  `QUANTITE_UTILISE` int NOT NULL,
  `INTERVENTION_IP` int NOT NULL,
  `PIECE_IP` int NOT NULL,
  PRIMARY KEY (`ID_INTERVENTION_PIECE`),
  KEY `INTERVENTION_PIECE_INTERVENTION_FK` (`INTERVENTION_IP`),
  KEY `INTERVENTION_PIECE_PIECE_FK` (`PIECE_IP`),
  CONSTRAINT `INTERVENTION_PIECE_INTERVENTION_FK` FOREIGN KEY (`INTERVENTION_IP`) REFERENCES `INTERVENTION` (`ID_INTERVENTION`),
  CONSTRAINT `INTERVENTION_PIECE_PIECE_FK` FOREIGN KEY (`PIECE_IP`) REFERENCES `PIECE` (`ID_PIECE`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='IP => INTERVENTION_PIECE';